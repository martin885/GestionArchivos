
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Lista de Archivos</title>
</h:head>
<h:body>

	<ui:insert name="upload"></ui:insert>

	<p:panel id="pnl" header="Lista de Archivos">
		<h:form id="myForm">

			<p:growl id="msgs" showDetail="true" />

			<p:dataTable tableStyle="table-layout: auto;"
				value="#{gestionBean.archivos}" var="archivo" id="myTable"
				rowKey="#{gestionBean.archivos.indexOf(archivo)}"
				selectionMode="single" editable="true"
				selection="#{gestionBean.archivoSeleccionado}" styleClass="myTable">

				<p:ajax event="rowEdit" listener="#{gestionBean.modificarNombre}"
					update=":myForm:msgs" />
				<p:ajax event="rowEditInit" listener="#{gestionBean.archivoEditar}"
					update=":myForm:msgs" />
				<p:ajax event="rowSelect" listener="#{gestionBean.verArchivo}"
					update=":myForm:msgs" />

				<p:column headerText="#" style="text-align: center;">
					<h:outputText value="#{gestionBean.archivos.indexOf(archivo)+1}" />
				</p:column>
				<p:column headerText="Nombre" style="text-align: left;">
					<p:cellEditor>
						<f:facet name="output">
							
								<h:outputText value="#{archivo.nombre}" style="display: block;"></h:outputText>
							
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{archivo.nombre}"></p:inputText>
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="Opciones" style="text-align: center;"
					rendered="#{p:ifGranted('ROLE_ADMIN')}">
					<p:rowEditor />
				</p:column>

			</p:dataTable>

			<p:contextMenu for="myTable" rendered="#{p:ifGranted('ROLE_ADMIN')}">
				<p:menuitem value="Eliminar" icon="pi pi-times"
					actionListener="#{gestionBean.eliminarArchivo}" update="myTable" />
			</p:contextMenu>

		</h:form>
	</p:panel>
</h:body>

</html>
